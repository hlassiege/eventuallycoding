<!DOCTYPE html>
<html data-head-attrs="">
<head><title>Play framework, binding et performance | EventuallyCoding</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><script src="https://digianalytics.fr/js/script.js" data-host="https://digianalytics.fr" data-dnt="false" id="ZwSg9rf6GA" async defer type="text/javascript"></script><meta name="description" content="Après avoir bataillé un bon moment avec les performances sur la page d’importation de Nemrod je me suis dit que ce serait intéressant de partager ce q..."><meta name="og:description" content="Après avoir bataillé un bon moment avec les performances sur la page d’importation de Nemrod je me suis dit que ce serait intéressant de partager ce q..."><meta name="og:type" content="article"><meta name="og:title" content="Play framework, binding et performance"><meta name="og:url" content="https://eventuallycoding.com/2011/10/23/play-framework-binding-et-performance"><meta name="og:image" content="https://eventuallycoding.com/images/covers/cover1.jpg"><meta name="og:image:alt" content="Play framework, binding et performance"><meta name="twitter:text:title" content="Play framework, binding et performance"><meta name="twitter:image" content="https://eventuallycoding.com/images/covers/cover1.jpg"><meta name="twitter:card" content="summary"><meta name="article:published_time" content="2011-10-23T00:00:00.000Z"><meta name="article:article:modified_time" content="2011-10-23T00:00:00.000Z"><meta name="article:article:tag" content="performance,play"><link rel="canonical" href="https://eventuallycoding.com/2011/10/23/play-framework-binding-et-performance"><meta name="head:count" content="17"><link rel="modulepreload" href="/2011/10/23/play-framework-binding-et-performance/_payload.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/entry.ba4c5fb3.js"><link rel="preload" as="style" href="/_nuxt/entry.2fb37f22.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/default.71b180f7.js"><link rel="preload" as="style" href="/_nuxt/TheHeader.19f98060.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/TheHeader.69ab59f9.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/TheFooter.384d3543.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/sitemetainfo.7469eb96.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/github_new.c6ffbd0b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/_id_.e697ef67.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/PageSidebar.50fbb4c8.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dropdown.1a988643.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/_commonjsHelpers.f8a6f4fc.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRenderer.67946971.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRendererMarkdown.0f897d19.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BlogCard.vue_vue_type_script_setup_true_lang.f347d181.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/asyncData.1fb97c84.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/query.1dc14db3.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/utils.68451c2c.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/HeroSection.a31753f4.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseP.a5ef3d91.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseA.94dbf0f4.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCode.291211da.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseStrong.01c7a41f.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/web-socket.4abb84fc.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/error-component.aaf4dcdf.js"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/rss.9e0b880c.svg"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/mastodon.f0ecdde8.svg"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/linkeding.34c3bc6d.svg"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/twitter.457cff27.svg"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/github_new.4e3fe23c.svg"><link rel="stylesheet" href="/_nuxt/entry.2fb37f22.css"><link rel="stylesheet" href="/_nuxt/TheHeader.19f98060.css"><style>.nuxt-content h2{font-size:28px;font-weight:700}.nuxt-content h3{font-size:22px;font-weight:700}.nuxt-content p{margin-bottom:20px}</style><style>.nuxt-content h2{font-size:28px;font-weight:700}.nuxt-content h3{font-size:22px;font-weight:700}.nuxt-content p{margin-bottom:20px}.clip-ellipse{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity));-webkit-clip-path:ellipse(60% 100% at 50% 0);clip-path:ellipse(60% 100% at 50% 0);height:100px;width:100%}</style><style>pre code .line{display:block;min-height:1rem}</style></head>
<body data-head-attrs=""><div id="__nuxt"><!--[--><section class="w-full pb-12 antialiased"><div class="mx-auto max-w-8xl"><div data-v-b5718d32><nav class="transition-colors fixed w-full z-10 top-0" id="header-menu" data-v-b5718d32><div class="max-w-7xl mx-auto px-2 sm:px-6 lg:px-8" data-v-b5718d32><div class="relative flex items-center justify-between h-16" data-v-b5718d32><div class="absolute inset-y-0 left-0 flex items-center sm:hidden" data-v-b5718d32><button type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false" data-v-b5718d32><span class="sr-only" data-v-b5718d32>Open main menu</span><svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" data-v-b5718d32><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" data-v-b5718d32></path></svg><svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" data-v-b5718d32><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" data-v-b5718d32></path></svg></button></div><div class="flex-1 flex items-center justify-center sm:items-stretch sm:justify-start" data-v-b5718d32><div class="flex-shrink-0 flex items-center" data-v-b5718d32><span class="text-white text-base font-medium font-bruno text-2xl font-to-invert-to-pink" data-v-b5718d32> EventuallyCoding.com </span></div><div class="hidden sm:block sm:ml-6 absolute right-0" data-v-b5718d32><div class="flex space-x-4" data-v-b5718d32><!--[--><a href="/" class="link text-white font-to-invert-to-black" data-v-b5718d32>Home</a><a href="/blog" class="link text-white font-to-invert-to-black" data-v-b5718d32>Blog</a><a href="/resources" class="link text-white font-to-invert-to-black" data-v-b5718d32>Resources</a><!--]--></div></div></div></div></div><div class="hidden" data-v-b5718d32><div class="px-2 pt-2 pb-3 space-y-1" data-v-b5718d32><!--[--><a href="/" class="text-white hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium font-to-invert-to-black" data-v-b5718d32>Home</a><a href="/blog" class="text-white hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium font-to-invert-to-black" data-v-b5718d32>Blog</a><a href="/resources" class="text-white hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium font-to-invert-to-black" data-v-b5718d32>Resources</a><!--]--></div></div></nav></div><!--[--><!--[--><div><section class="flex items-center justify-center h-128 bg-transparent"><canvas id="c" class="-z-10 absolute w-full h-128 block"></canvas><div class="clip-ellipse absolute top-124 rotate-180"></div><!--[--><div class="absolute top-96 w-96 -translate-y-20"><img src="/images/covers/cover1.jpg" alt="Play framework, binding et performance" class="object-cover"></div><!--]--></section><div class="px-4 mx-auto sm:px-6 xl:max-w-7xl xl:px-0 mt-10"><h1 class="text-4xl text-gray-700 font-extrabold mb-10 text-center">Play framework, binding et performance</h1><div class="grid grid-cols-3 text-center sm:w-full md:w-1/2 mx-auto"><div><p class="text-center font-bold my-5 text-slate-400 text-xs"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> October 23, 2011</p></div><div><p class="text-center font-bold my-5 text-slate-400 text-xs"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> 3 min read</p></div><div class="flex items-center font-medium sm:mx-3 justify-center"><img src="/hugo-nb.jpg" loading="lazy" alt="" class="mr-3 w-10 h-10 rounded-full bg-slate-50 dark:bg-slate-800"><div><div class="font-bold text-slate-400 text-xs">Hugo Lassiège</div><a target="_blank" href="https://twitter.com/hugolassiege" class="font-bold text-sky-400 text-xs hover:text-sky-600"> @hugolassiege</a></div></div></div><div class="sm:w-full md:w-1/2 mx-auto"><p class="mt-2 text-xs my-3 flex flex-wrap -m-1 justify-center"><!--[--><a href="/blog?tag=performance" class="m-1 leading-loose text-slate-400 border border-current lowercase px-2 rounded font-medium">#performance</a><a href="/blog?tag=play" class="m-1 leading-loose text-slate-400 border border-current lowercase px-2 rounded font-medium">#play</a><!--]--></p></div><div class="text-left mx-auto"><div class="flex flex-wrap lg:flex-row-reverse py-12"><!----><div class="w-full px-5 max-w-none centered-image"><div id="nuxtContent" class="prose font-proxima text-sm md:text-xl font-medium min-w-full md:p-10 mx-auto"><p><!--[-->Après avoir bataillé un bon moment avec les performances sur la page d’importation de Nemrod je me suis dit que ce serait intéressant de partager ce que j’ai appris sur le binding de Play. Bref, je vous propose ce petit sujet autour du binding dans Play framework et une optimisation qui m’a sauvé la vie. Resituons le contexte tout d’abord. Si vous utilisez <a href="http://www.playframework.org/" rel="nofollow"><!--[-->Play framework<!--]--></a>, vous avez peut être déjà utilisé <a href="http://www.playframework.org/documentation/1.2.3/controllers#array" rel="nofollow"><!--[-->des bindings avec des collections d’éléments<!--]--></a> dans un de vos contrôleur.<!--]--></p><p><!--[-->Ce type de binding est excessivement utile dans la majorité des cas. Prenons par exemple le bout de template suivant :<!--]--></p><!--[--><pre><code>#{list items:results, as:&#39;result&#39; }
   
   
   
   
#{/list}
</code></pre><!--]--><p><!--[-->Ceci va vous créer dans votre page html une suite d’élément html comme suit :<!--]--></p><!--[--><pre><code>           …..........
</code></pre><!--]--><p><!--[-->Pour traiter ensuite ce résultat dans votre contrôleur, il ne vous reste plus qu’à déclarer :<!--]--></p><p><!--[-->public static void process(Listresults)<!--]--></p><p><!--[-->ImportBean étant un simple objet ayant 4 propriété : filename, module, modulepath et localeId<!--]--></p><p><!--[-->Autrement dit, Play framework a fait le binding pour vous entre les données de votre formulaire et une collection d’objets.<!--]--></p><p><!--[--><strong><!--[-->C’est vrai, c’est super puissant et c’est la méthode conseillée dans la majorité des cas.<!--]--></strong><!--]--></p><p><!--[-->De mon côté j’ai rencontré un cas où la taille de ma collection était de plus de 400 éléments et cela s’est avéré catastrophique.<!--]--></p><p><!--[-->Prenons la méthode d’un contrôleur comme suit :<!--]--></p><!--[--><pre><code>public static void process(Listresults)     {
 
      for (ImportBean importBean : results)
      {
          await(doSomething());
      }

       render();

}
</code></pre><!--]--><p><!--[-->Le temps nécessaire pour effectuer le traitement durait plus de <strong><!--[-->2h<!--]--></strong> ! J’ai évidemment soupçonné le temps de traitement dans doSomething mais après avoir mis en place quelques éléments pour mesurer les temps d&#39;exécution, je n’ai rien trouvé de concluant dans la méthode doSomething. Par contre, j’ai remarqué qu’à chaque tour de boucle la récupération d’un élément de results prenait un temps fou. L’entrée même dans la méthode process dépassait les 10 secondes.<!--]--></p><p><!--[-->J’ai donc soupçonné le binding effectué par Play. Même si j’avoue ne pas avoir compris pourquoi je perdais du temps à chaque itération (du lazy loading pour le binding peut être ?) Pour valider cette théorie, j’ai modifié le code de la façon suivante :<!--]--></p><p><!--[-->J’ai remplacé<!--]--></p><!--[--><pre><code>#{list items:results, as:&#39;result&#39; }
   
   
   
   
#{/list}
</code></pre><!--]--><p><!--[-->par<!--]--></p><p><!--[-->resultJson étant une chaîne représentant ma collection au format json.<!--]--></p><p><!--[-->Côté contrôleur, je récupère donc une chaîne de caractère et non plus une collection. Cette chaine est désérialisé puis utilisé dans le même traitement que précédemment.<!--]--></p><p><!--[-->public static void process(String resultJson)
{
GsonBuilder builder = new GsonBuilder();
Type collectionType = new TypeToken<list>(){}.getType();
Listresults = builder.create().fromJson(resultJson, collectionType);</list><!--]--></p><!--[--><pre><code>   for (ImportBean importBean : results)
   {
       await(doSomething());
   }

   render();
</code></pre><!--]--><p><!--[-->}<!--]--></p><p><!--[-->Résultat des courses, le traitement qui s’effectuait auparavant en environ 2h s’effectue désormais en moins de deux minutes !<!--]--></p><p><!--[-->Bref, heureusement que j’ai posé les sondes aux bons endroits avant d’entamer des optimisations dans doSomething, ce qui ne m’aurait rien apporté au final.<!--]--></p><p><!--[-->Voila, en espérant que ça vous serve peut être.<!--]--></p></div></div></div></div><hr class="mb-12"><div><span> Partager sur : </span><div class="mt-4"><a href="https://facebook.com/sharer/sharer.php?u=https://eventuallycoding.com2011/10/23/play-framework-binding-et-performance" target="_blank" rel="noopener" aria-label=""><button type="button" class="text-white bg-[#3b5998] hover:bg-[#3b5998]/90 focus:ring-4 focus:outline-none focus:ring-[#3b5998]/50 font-medium rounded-lg text-sm px-3 py-3 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55 mr-2 mb-2"><svg class="w-6 h-6" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook-f" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M279.1 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.4 0 225.4 0c-73.22 0-121.1 44.38-121.1 124.7v70.62H22.89V288h81.39v224h100.2V288z"></path></svg></button></a><a href="https://twitter.com/share?url=https://eventuallycoding.com2011/10/23/play-framework-binding-et-performance&amp;text=Play framework, binding et performance&amp;via=hugolassiege" target="_blank" title="Share on Twitter" rel="noopener noreferrer"><button type="button" class="text-white bg-[#1da1f2] hover:bg-[#1da1f2]/90 focus:ring-4 focus:outline-none focus:ring-[#1da1f2]/50 font-medium rounded-lg text-sm px-3 py-3 text-center inline-flex items-center dark:focus:ring-[#1da1f2]/55 mr-2 mb-2"><svg class="w-6 h-6" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.4 151.7c.325 4.548 .325 9.097 .325 13.65 0 138.7-105.6 298.6-298.6 298.6-59.45 0-114.7-17.22-161.1-47.11 8.447 .974 16.57 1.299 25.34 1.299 49.06 0 94.21-16.57 130.3-44.83-46.13-.975-84.79-31.19-98.11-72.77 6.498 .974 12.99 1.624 19.82 1.624 9.421 0 18.84-1.3 27.61-3.573-48.08-9.747-84.14-51.98-84.14-102.1v-1.299c13.97 7.797 30.21 12.67 47.43 13.32-28.26-18.84-46.78-51.01-46.78-87.39 0-19.49 5.197-37.36 14.29-52.95 51.65 63.67 129.3 105.3 216.4 109.8-1.624-7.797-2.599-15.92-2.599-24.04 0-57.83 46.78-104.9 104.9-104.9 30.21 0 57.5 12.67 76.67 33.14 23.72-4.548 46.46-13.32 66.6-25.34-7.798 24.37-24.37 44.83-46.13 57.83 21.12-2.273 41.58-8.122 60.43-16.24-14.29 20.79-32.16 39.31-52.63 54.25z"></path></svg></button></a></div></div><!----><div id="hyvor-talk-view"></div></div></div><!--]--><!--]--><footer class="lg:mt-52 border-t border-t-2"><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a target="_self" href="/rss.xml" class="text-sm text-gray-500 transition hover:text-gray-600"><img class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/rss.9e0b880c.svg"></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="me"><span class="sr-only">Mastodon</span><img class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/mastodon.f0ecdde8.svg"></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="nofollow noopener noreferrer" href="https://github.com/hlassiege"><span class="sr-only">github</span><img class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/github_new.4e3fe23c.svg"></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/hugolassiege/"><span class="sr-only">Linkedin</span><img class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/linkeding.34c3bc6d.svg"></a><a target="_blank" rel="nofollow noopener noreferrer" href="https://twitter.com/hugolassiege" class="text-sm text-gray-500 transition hover:text-gray-600"><img class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/twitter.457cff27.svg"></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Copyright © 2022</div><div>•</div> EventuallyCoding - A la fin de l&#39;envoi, je code !</div><div class="text-sm text-gray-500">Credits to www.freepik.com - <a href="https://www.freepik.com/vectors/citizen">Citizen vector created by freepik - </a><a href="https://www.freepik.com/vectors/css">Css vector created by vectorjuice</a></div></div></footer></div></section><!--]--></div><script type="module">import p from "/2011/10/23/play-framework-binding-et-performance/_payload.js";window.__NUXT__={...p,...((function(a,b){return {state:{},_errors:{},serverRendered:true,config:{public:{content:{clientDB:{isSPA:a,integrity:1668177809323},navigation:{fields:[]},base:"_content",tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"prose-code",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:a,wsUrl:b,documentDriven:a,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"\u002F",buildAssetsDir:"\u002F_nuxt\u002F",cdnURL:b}},prerenderedAt:1668177846244}}(false,"")))}</script><script type="module" src="/_nuxt/entry.ba4c5fb3.js" crossorigin></script><script type="module" src="/_nuxt/default.71b180f7.js" crossorigin></script><script type="module" src="/_nuxt/TheHeader.69ab59f9.js" crossorigin></script><script type="module" src="/_nuxt/_id_.e697ef67.js" crossorigin></script><script type="module" src="/_nuxt/TheFooter.384d3543.js" crossorigin></script><script type="module" src="/_nuxt/HeroSection.a31753f4.js" crossorigin></script><script type="module" src="/_nuxt/ContentRenderer.67946971.js" crossorigin></script><script type="module" src="/_nuxt/ContentRendererMarkdown.0f897d19.js" crossorigin></script><script type="module" src="/_nuxt/ProseP.a5ef3d91.js" crossorigin></script><script type="module" src="/_nuxt/ProseA.94dbf0f4.js" crossorigin></script><script type="module" src="/_nuxt/ProseCode.291211da.js" crossorigin></script><script type="module" src="/_nuxt/ProseStrong.01c7a41f.js" crossorigin></script></body>
</html>