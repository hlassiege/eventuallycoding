<!DOCTYPE html>
<html lang="fr">
<head><meta charset="utf-8">
<title>PAAS or not PAAS, that is the question | EventuallyCoding</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://digianalytics.fr/js/script.js" data-host="https://digianalytics.fr" id="ZwSg9rf6GA" async="" defer="" type="text/javascript"></script>
<meta name="description" content="[![paas](/images/e3efe-paas.png)](http://eventuallycoding.com/wp-content/uploads/2014/05/e3efe-paas.png)Jusqu’à récemment HopWork tournait sur un PAAS...">
<meta name="og:description" content="[![paas](/images/e3efe-paas.png)](http://eventuallycoding.com/wp-content/uploads/2014/05/e3efe-paas.png)Jusqu’à récemment HopWork tournait sur un PAAS...">
<meta name="og:type" content="article">
<meta name="og:title" content="PAAS or not PAAS, that is the question">
<meta name="og:url" content="https://eventuallycoding.com/2014/05/09/paas-or-not-paas-that-is-the-question">
<meta name="og:image" content="https://eventuallycoding.com/images/covers/cover7.jpg">
<meta name="og:image:alt" content="PAAS or not PAAS, that is the question">
<meta name="twitter:text:title" content="PAAS or not PAAS, that is the question">
<meta name="twitter:image" content="https://eventuallycoding.com/images/covers/cover7.jpg">
<meta name="twitter:card" content="summary">
<meta name="article:published_time" content="2014-05-09T00:00:00.000Z">
<meta name="article:article:modified_time" content="2014-05-09T00:00:00.000Z">
<meta name="article:article:tag" content="devops,paas">
<link rel="canonical" href="https://eventuallycoding.com/2014/05/09/paas-or-not-paas-that-is-the-question">
<link rel="alternate" href="https://eventuallycoding.com/2014/05/09/paas-or-not-paas-that-is-the-question" hreflang="fr"><link rel="modulepreload" href="/2014/05/09/paas-or-not-paas-that-is-the-question/_payload.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/entry.215acb14.js"><link rel="preload" as="style" href="/_nuxt/entry.0383308f.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/default.8bde6c5b.js"><link rel="preload" as="style" href="/_nuxt/TheHeader.e21518f4.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/nuxt-link.854e2e84.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/siteMetaData.b74feb44.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/_id_.17522db5.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dropdown.e3430081.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/_commonjsHelpers.28e086c5.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRenderer.1f0e0fa2.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRendererMarkdown.ef476ca4.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/index.a6ef77ff.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/query.4c75ccbe.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/index.61d74bb5.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/utils.750e18cd.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/composables.95439764.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseP.a08a8556.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH2.47da4369.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseA.f7a1a7a8.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseUl.ec4b424e.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseLi.a40261ef.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseStrong.4f906ff3.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseImg.5114fcaa.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseBlockquote.69b83896.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseEm.9338c12f.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/error-component.11681c18.js"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/github_new.4e3fe23c.svg"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/rss.9e0b880c.svg"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/mastodon.f0ecdde8.svg"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/linkeding.34c3bc6d.svg"><link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/twitter.457cff27.svg"><link rel="stylesheet" href="/_nuxt/entry.0383308f.css"><link rel="stylesheet" href="/_nuxt/TheHeader.e21518f4.css"><style>.inverted[data-v-a060ef80]{--tw-bg-opacity:1;background-color:rgb(248 250 252/var(--tw-bg-opacity))}.inverted .font-to-invert-to-pink[data-v-a060ef80]{color:rgb(236 72 153/var(--tw-text-opacity))}.inverted .font-to-invert-to-black[data-v-a060ef80],.inverted .font-to-invert-to-pink[data-v-a060ef80]{--tw-text-opacity:1;transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.inverted .font-to-invert-to-black[data-v-a060ef80]{color:rgb(51 65 85/var(--tw-text-opacity))}.inverted .font-to-invert-to-black[data-v-a060ef80]:hover{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.link[data-v-a060ef80]{display:block;font-size:1rem;font-weight:500;line-height:1.5rem;overflow:hidden;padding-left:.75rem;padding-right:.75rem;position:relative;text-decoration:none}.link.NuxtLink-exact-active[data-v-a060ef80]:after{bottom:-2px;height:100%;left:0;width:100%}.link[data-v-a060ef80]:after{background:rgba(236,64,122,.25);bottom:-6px;content:"";height:calc(100% - 8px);left:18px;position:absolute;transition:.35s cubic-bezier(.25,.1,0,2.05);width:calc(100% - 8px);z-index:-1}.link[data-v-a060ef80]:hover:after{bottom:-2px;height:100%;left:0;width:100%}</style><style>.nuxt-content h2{font-size:28px;font-weight:700}.nuxt-content h3{font-size:22px;font-weight:700}.nuxt-content p{margin-bottom:20px}</style></head>
<body ><div id="__nuxt"><!--[--><section class="w-full pb-12 antialiased"><div class="mx-auto max-w-8xl"><div data-v-a060ef80><nav id="header-menu" class="transition-colors fixed w-full z-10 top-0 inverted" data-v-a060ef80><div class="max-w-7xl mx-auto px-2 sm:px-6 lg:px-8" data-v-a060ef80><div class="relative flex items-center justify-between h-16" data-v-a060ef80><div class="absolute inset-y-0 left-0 flex items-center sm:hidden" data-v-a060ef80><button type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" aria-controls="mobile-menu" aria-expanded="false" data-v-a060ef80><span class="sr-only" data-v-a060ef80>Open main menu</span><svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" data-v-a060ef80><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" data-v-a060ef80></path></svg><svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" data-v-a060ef80><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" data-v-a060ef80></path></svg></button></div><div class="flex-1 flex items-center justify-center sm:items-stretch sm:justify-start" data-v-a060ef80><div class="flex-shrink-0 flex items-center" data-v-a060ef80><span class="text-white text-base font-medium font-bruno text-2xl font-to-invert-to-pink" data-v-a060ef80><a href="/" class="" data-v-a060ef80>EventuallyCoding.com</a></span></div><div class="hidden sm:block sm:ml-6 absolute right-0 font-mark" data-v-a060ef80><div class="flex space-x-4" data-v-a060ef80><!--[--><a href="/speaking" class="link text-white font-to-invert-to-black" data-v-a060ef80>Speaking</a><a href="/blog" class="link text-white font-to-invert-to-black" data-v-a060ef80>Writing</a><a href="/resources" class="link text-white font-to-invert-to-black" data-v-a060ef80>Resources</a><a href="/about" class="link text-white font-to-invert-to-black" data-v-a060ef80>About</a><!--]--></div></div></div></div></div><div class="hidden" data-v-a060ef80><div class="px-2 pt-2 pb-3 space-y-1" data-v-a060ef80><!--[--><a href="/speaking" class="text-white hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium font-to-invert-to-black" data-v-a060ef80>Speaking</a><a href="/blog" class="text-white hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium font-to-invert-to-black" data-v-a060ef80>Writing</a><a href="/resources" class="text-white hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium font-to-invert-to-black" data-v-a060ef80>Resources</a><a href="/about" class="text-white hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium font-to-invert-to-black" data-v-a060ef80>About</a><!--]--></div></div></nav></div><!--[--><!--[--><div><div class="flex justify-center mt-24"><img src="/images/covers/cover7.jpg" alt="PAAS or not PAAS, that is the question" class="object-cover w-96"></div><div class="px-4 mx-auto sm:px-6 xl:max-w-7xl xl:px-0 mt-10"><div><h1 class="text-4xl text-gray-700 font-extrabold text-center mb-3">PAAS or not PAAS, that is the question</h1><p class="text-slate-400 text-center mb-1"><!----></p><div class="grid grid-cols-3 text-center sm:w-full md:w-1/2 mx-auto"><div><p class="text-center font-bold my-4 text-slate-400 text-xs"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> May 9, 2014</p></div><div><p class="text-center font-bold my-4 text-slate-400 text-xs"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> 10 min read</p></div><div class="flex items-center font-medium sm:mx-3 justify-center"><img src="/hugo-nb.jpg" loading="lazy" alt="" class="mr-3 w-10 h-10 rounded-full bg-slate-50 dark:bg-slate-800"><div><div class="font-bold text-slate-400 text-xs">Hugo Lassiège</div><a target="_blank" href="https://twitter.com/hugolassiege" class="font-bold text-sky-400 text-xs hover:text-sky-600"> @hugolassiege</a></div></div></div></div><div class="text-left mx-auto"><div class="flex flex-wrap lg:flex-row-reverse py-12"><div class="w-full lg:w-1/4 px-5"><div class="lg:sticky top-0 pt-5 -mt-5 font-proxima"><div class="toc hidden lg:block"><p class="border-b-4 pb-3 mb-3 border-gray-200 text-xl"> On this page </p><ul class="pl-0"><!--[--><li class="py-1"><a class="hover:text-smalt-blue-700" href="#les-coûts">Les coûts ?</a></li><li class="py-1"><a class="hover:text-smalt-blue-700" href="#la-scalabilité">La scalabilité ?</a></li><li class="py-1"><a class="hover:text-smalt-blue-700" href="#nos-choix">Nos choix</a></li><!--]--></ul></div><div class="text-right mb-12"><div class="relative inline-block text-left ml-2 block lg:hidden"><div><span class="rounded-md shadow-sm"><button type="button" class="inline-flex justify-center w-full rounded-md border border-gray-300 px-4 py-2 bg-white text-sm leading-5 font-medium text-black hover:text-white hover:bg-smalt-blue-500 focus:outline-none transition ease-in-out duration-150" aria-haspopup="true" aria-expanded="true"><!--[-->On this page<!--]--><svg class="-mr-1 ml-2 h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></span></div><!----></div></div></div></div><div class="lg:w-3/4 w-full px-5 max-w-none centered-image"><div id="nuxtContent" class="prose font-proxima text-sm md:text-xl font-medium min-w-full md:p-10 mx-auto"><p><!--[--><a href="http://eventuallycoding.com/wp-content/uploads/2014/05/e3efe-paas.png" rel="nofollow"><!--[--><img src="/images/e3efe-paas.png" alt="paas"><!--]--></a>Jusqu’à récemment HopWork tournait sur un PAAS, mais ça va changer. Pour les quelques uns qui ont dormi ces dernières années, un PAAS c’est l’acronyme de Platform as a service. En très gros c’est un cadre de travail pour délivrer rapidement votre code en production avec tout un ensemble de services préinstallés, gérés pour vous et qui s’associent simplement avec votre applicatif.<!--]--></p><p><!--[-->Pour simplifier très fort, c’est ce qui permet au développeur de faire un simple : “git push <em><!--[-->provider<!--]--></em> master” pour que magiquement votre dernière version sur git se retrouve en prod.<!--]--></p><p><!--[-->Remplacez ici “provider” par <a href="http://www.cloudbees.com/" rel="nofollow"><!--[-->Cloudbees<!--]--></a>, <a href="http://www.heroku.com" rel="nofollow"><!--[-->Heroku<!--]--></a>, <a href="https://www.clever-cloud.com/fr/" rel="nofollow"><!--[-->Clever-Cloud<!--]--></a>, <a href="https://appengine.google.com/" rel="nofollow"><!--[-->Google App Engine<!--]--></a> etc...<!--]--></p><p><!--[-->Au tout début d’un projet comme <a href="http://www.hopwork.com/" rel="nofollow"><!--[-->HopWork<!--]--></a>, le choix d’un PAAS se fait naturellement. Tout ceux qui ont un projet en tête, qui souhaitent le prototyper rapidement et le montrer, le PAAS est votre ami. Vous ne vous concentrez que sur votre code et quelques paramétrages relativement légers sur votre PAAS. En plus, bien souvent, pour de petites utilisations un PAAS va se révéler très peu coûteux, voire même gratuit.<!--]--></p><p><!--[-->Pour notre part, nous avions choisi Heroku. Heroku propose un système de worker et pour un seul worker vous ne payez pas.<!--]--></p><p><!--[-->Par contre un PAAS s’accompagne de quelques contraintes qu’il faut apprendre à respecter. Par exemple chez Heroku :<!--]--></p><ul><!--[--><li><!--[-->les disques sont volatiles<!--]--></li><li><!--[-->votre appli doit être rapide à booter<!--]--></li><li><!--[-->l’environnement d’execution est contraint (512Mo de ram pour un worker Heroku)<!--]--></li><li><!--[-->avec un seul worker sur Heroku, si pas d’activité, votre appli est mise en hibernation (donc elle doit être rapide à redémarrer par la suite)<!--]--></li><!--]--></ul><p><!--[-->Au dessus de votre PAAS vous allez rapidement faire appel à des SAAS (Software as a service). Sur HopWork nous avons utilisé ou utilisons encore :<!--]--></p><ul><!--[--><li><!--[--><a href="http://www.mongohq.com/" rel="nofollow"><!--[-->MongoHq<!--]--></a> puis <a href="https://mongolab.com/welcome/" rel="nofollow"><!--[-->Mongolab<!--]--></a> (mongodb as a service)<!--]--></li><li><!--[--><a href="http://cloudinary.com/" rel="nofollow"><!--[-->Cloudinary<!--]--></a> (gestion des images)<!--]--></li><li><!--[--><a href="http://www.searchly.com/" rel="nofollow"><!--[-->Searchbox<!--]--></a> devenu Searchly (elasticsearch as a service)<!--]--></li><li><!--[--><a href="https://mailgun.com/" rel="nofollow"><!--[-->Mailgun<!--]--></a> puis <a href="https://mandrillapp.com/" rel="nofollow"><!--[-->Mandrill<!--]--></a> (envoi de mail transactionnel)<!--]--></li><li><!--[--><a href="http://www.twilio.com/" rel="nofollow"><!--[-->Twilio<!--]--></a> (envoi de SMS)<!--]--></li><li><!--[--><a href="http://www.mangopay.com/" rel="nofollow"><!--[-->Mangopay<!--]--></a> (paiement)<!--]--></li><li><!--[--><a href="http://fr.zendesk.com/" rel="nofollow"><!--[-->Zendesk<!--]--></a> (pour le support)<!--]--></li><li><!--[--><a href="http://www.livechatinc.com/" rel="nofollow"><!--[-->Livechat<!--]--></a> (pour le support)<!--]--></li><li><!--[--><a href="https://logentries.com/" rel="nofollow"><!--[-->Logentries<!--]--></a> (analyse et conservation des logs)<!--]--></li><li><!--[--><a href="http://www.monitor.us/" rel="nofollow"><!--[-->monitorus<!--]--></a>/<a href="https://www.pingdom.com/" rel="nofollow"><!--[-->pingdom<!--]--></a>/<a href="http://newrelic.com/" rel="nofollow"><!--[-->new relic<!--]--></a> (monitoring)<!--]--></li><li><!--[--><a href="http://www.localizeyourapps.com/" rel="nofollow"><!--[-->Localizeyourapps<!--]--></a> (pour la localisation)<!--]--></li><!--]--></ul><p><!--[-->(pour localizeyourapps, ne cherchez pas, c’est moi qui le développais, c’est plus ou moins mort pour l’instant)<!--]--></p><p><!--[-->Pour ces quelques services, nous en avons évalué d’autres et continuons à en évaluer régulièrement (<a href="http://www.cloudamqp.com/" rel="nofollow"><!--[-->CloudAmqp<!--]--></a>, <a href="http://www.fasterize.com/fr" rel="nofollow"><!--[-->Fasterize<!--]--></a> et <a href="http://www.cloudflare.com/" rel="nofollow"><!--[-->Cloudflare<!--]--></a> sont dans les tuyaux par exemple).<!--]--></p><p><!--[-->Là encore, pour des utilisations légères, ces services proposent souvent des plans gratuits qui vont être utilisables pendant longtemps.<!--]--></p><p><!--[--><em><!--[-->Alors pourquoi changer ?<!--]--></em><!--]--></p><p><!--[-->Pour être honnête, c’est un choix difficile de changer et de revenir sur un serveur dédié pour une partie des services. Quelle plus-value ? Quelle moins-value ?<!--]--></p><h2 id="les-coûts"><a href="#les-coûts"><!--[-->Les coûts ?<!--]--></a></h2><p><!--[-->Selon moi un produit connaît plusieurs phases.<!--]--></p><p><!--[-->Au tout début d’un produit, vous faites tout avec des bouts de ficelles car vous avez zéro budget. De plus vous voulez montrer très vite ce que vous faites. Le PAAS est l’idéal pour cela et vous permet d’être concentré sur votre appli et rien d’autre. (Au diable la sécurité ! :))<!--]--></p><p><!--[-->Ensuite si vous avez de la chance, votre soft rencontre un peu de succès, vous avez des sous mais vous devez passer sur des plans tarifaires supérieurs pour certains services que vous utilisez. Vous êtes dans la période où vous devez perpétuellement jongler entre la surveillance des coûts et la rapidité d’exécution. Soyons clair, on doit toujours jongler avec ça, mais dans cette période d’autant plus.<!--]--></p><p><!--[-->Pour illustrer, voici les coûts mensuels des services avec notre traffic actuel :<!--]--></p><ul><!--[--><li><!--[-->Heroku 1 worker de 1024Mo : 35$<!--]--></li><li><!--[-->Heroku : certificat SSL : 20$<!--]--></li><li><!--[-->Cloudinary : 30$<!--]--></li><li><!--[-->Mandrill/Mailchimp : 35$<!--]--></li><li><!--[-->Twilio : cout fixe par SMS<!--]--></li><li><!--[-->Mangopay : % par transaction<!--]--></li><!--]--></ul><p><!--[-->A cela s’ajoute des coûts qui vont ou pourraient arriver :<!--]--></p><ul><!--[--><li><!--[-->Nous sommes à la limite de devoir passer sur un plan payant pour MongoLab : 15$<!--]--></li><li><!--[-->Si nous étions restés chez Searchbox : 9$<!--]--></li><li><!--[-->Nous sommes en fin de période “promo” chez Zendesk, le cout passe ensuite à 25$ + 29$ par “agent support”.<!--]--></li><li><!--[-->Pour bien faire il faudrait 2 worker Heroku : 70$<!--]--></li><li><!--[-->Logentries si on veut garder les logs plus longtemps ce sera 19$<!--]--></li><!--]--></ul><p><!--[-->Mais <strong><!--[-->on ne peut pas comparer<!--]--></strong> SAAS et “fait maison” en parlant que des coûts :<!--]--></p><ul><!--[--><li><!--[-->Mangopay c’est du paiement et nous n’avons pas vocation à en faire nous-mêmes<!--]--></li><li><!--[-->Mandrill, Twilio, Cloudinary, Zendesk proposent des services à forte valeur ajoutée et nous perdrions beaucoup de temps à le refaire<!--]--></li><li><!--[-->A l’inverse certains produits même sur des plans supérieurs ne proposent pas exactement les fonctionnalités que l’on souhaiterait (comme Logentries)<!--]--></li><li><!--[-->De toute façon je ne vous ai pas encore parlé des coûts du “fait maison” :)<!--]--></li><!--]--></ul><p><!--[-->Pour être clair nous allons continuer à utiliser du SAAS pour des services à forte valeur ajoutée car cela n’aurait pas de sens de les refaire de notre côté. Cela reste dans l’optique d’une architecture micro-service telle que nous la concevons sur HopWork (Certains SAAS continueront cependant à être évalués régulièrement face à leurs concurrents). Ce qui est remis en cause c’est uniquement un subset de tout ces services :<!--]--></p><ul><!--[--><li><!--[-->mongo<!--]--></li><li><!--[-->elasticsearch<!--]--></li><li><!--[-->logentries (et encore celui-ci se discute)<!--]--></li><li><!--[-->Rabbitmq<!--]--></li><li><!--[-->et le PAAS : Heroku<!--]--></li><!--]--></ul><p><!--[-->En fait vous remarquerez que j’ai fait le distinguo entre les SAAS à forte valeur ajoutée, et les SAAS qui proposent de l’infra.<!--]--></p><p><!--[-->Pour ceux la, sur HopWork il nous semble que c’est justement le moment où les coûts restent maîtrisables mais nous commencons à les sentir et on note voyez que les plans tarifaires encore au dessus vont être vraiment plus chers (entre 89 et 200$ mensuel en entrée de gamme selon ce qu’on cherche chez mongolab).<!--]--></p><p><!--[-->De toute façon sur les plans de base, c’est souvent labellisé <strong><!--[-->“sandbox” ou “developpement”<!--]--></strong> avec tout ce que ca implique donc nous avons fortement intérêt à upgrader et là <a href="https://mongolab.com/plans/pricing/#dedicated-cluster-plans" rel="nofollow"><!--[-->ca peut faire très mal<!--]--></a>.<!--]--></p><p><!--[-->Au delà de ça, avoir son elasticsearch et sa base mongo accessible sur le net, même protégé par un login/password, ca reste moyen. Nous en avons eu récemment l’expérience avec Heartbleed, tout les providers sans exception nous ont demandé de changer les credentials et clés d’API utilisés sur leurs services.<!--]--></p><p><!--[-->Pire, il y a quelques mois, seul Searchbox proposait un elastisearch as a service sécurisé.<!--]--></p><h2 id="la-scalabilité"><a href="#la-scalabilité"><!--[-->La scalabilité ?<!--]--></a></h2><p><!--[-->Une promesse de ces services, c’est la scalabilité et l’élasticité. Ici par exemple le slogan d’Heroku :<!--]--></p><blockquote><!--[--><p><!--[-->Build, run, and scale apps.<!--]--></p><p><!--[-->Cloud computing designed and built for developers.<!--]--></p><!--]--></blockquote><p><!--[-->Sauf que “scaler” n’est pas une de vos priorités immédiate. Construire des clusters de mongodb avec du sharding ou gérer un traffic de 10000 visiteurs/minutes ce sera dans longtemps. Enfin pas trop, je vous le souhaite, mais pas immédiatement.<!--]--></p><p><!--[-->HopWork c’est 4000 inscrits, un peu moins de 1000 visites/jour (ca augmente chaque mois). C’est très honorable mais ca représente pas tant que ça pour une machine bien dimensionnée et bien utilisée. Pour l’instant la priorité c’est les fonctionnalités, pas la tenue en charge.<!--]--></p><p><!--[-->Par contre cette fameuse “scalabilité”, quand vous avez une appli simple vous la payez alors que vous n’en profitez pas.<!--]--></p><p><!--[-->Déjà vous avez une application distribuée, c’est cool mais contrairement à ce que certains croient, <a href="http://en.wikipedia.org/wiki/Fallacies_of_Distributed_Computing" rel="nofollow"><!--[-->c’est pas le paradis<!--]--></a> (le réseau n’est pas fiable, la bande passante n’est pas illimitée, etc…)<!--]--></p><p><!--[-->Parmi les fausses croyances du distribuée, on pense que les latences sont négligeables <a href="http://www.addsimplicity.com/adding_simplicity_an_engi/2007/02/latency_exists_.html" rel="nofollow"><!--[-->mais elles existent bel et bien<!--]--></a>.<!--]--></p><p><!--[-->Par exemple entre un Heroku sur zone US et un Heroku sur zone EU vous avez une latence qui varie entre 200 et 300ms. Entre une appli hébergé sur Amazon EU (Irelande) et une base Mongo hébergé en France (OVH), vous avez une latence qui varie entre 50 et 150ms.<!--]--></p><h2 id="nos-choix"><a href="#nos-choix"><!--[-->Nos choix<!--]--></a></h2><p><!--[-->Si je résume, en fait nous sommes en cours de migration de certains services pour les raisons suivantes :<!--]--></p><ul><!--[--><li><!--[-->le coût (pour ce qui concerne le PAAS, les bases de données, files de messages)<!--]--></li><li><!--[-->la sécurité<!--]--></li><li><!--[-->des besoins actuels simples en terme de scalabilité<!--]--></li><li><!--[-->des besoins de meilleure performance (des latences moins élevés)<!--]--></li><!--]--></ul><p><!--[-->Comme je le disais plus haut, le choix de repasser sur du dédié sur certains services fut difficile. Nous nous sommes donc posé deux contraintes simples :<!--]--></p><ul><!--[--><li><!--[-->il doit être possible de refaire le chemin inverse facilement<!--]--></li><li><!--[-->la simplicité de mise en prod doit être maintenue<!--]--></li><!--]--></ul><p><!--[-->Ce qui implique des choix assez évidents :<!--]--></p><ul><!--[--><li><!--[-->ne toujours pas reposer sur le disque, faire comme s’il était volatile<!--]--></li><li><!--[-->le serveur lui-même est considéré comme volatile, il peut à tout moment crasher. Il doit donc pouvoir être remonté rapidement et automatiquement<!--]--></li><li><!--[-->avoir une appli qui boote très rapidement<!--]--></li><li><!--[-->ne pas bouffer des ressources comme des malades :)<!--]--></li><li><!--[-->conserver un workflow simple de déploiement, idéalement basé sur git<!--]--></li><li><!--[-->garder un découplage maximal entre les différents composants de l’architecture<!--]--></li><!--]--></ul><p><!--[-->Factuellement, pour héberger tout cela, nous avons pris un serveur OVH Soyoustart 32Gb de ram, disque SSD, 8 coeurs pour 40euros/mois. En terme de ressources et en simplifiant grossièrement cela représente 64 workers Heroku (évidemment c’est exagéré, une appli a une empreinte sur la machine qui ne se résume pas à sa heap).<!--]--></p><p><!--[-->Pour l’installation des composants, nous utilisons <a href="http://www.ansible.com/" rel="nofollow"><!--[-->Ansible<!--]--></a>.<!--]--></p><p><!--[-->Pour le déploiement applicatif, le choix n’est pas encore posé, c’est l’étape qui reste à faire. Il existe plusieurs pistes : <a href="https://github.com/arnoo/git-deliver/" rel="nofollow"><!--[-->git-deliver<!--]--></a>, <a href="https://github.com/mislav/git-deploy" rel="nofollow"><!--[-->git-deploy<!--]--></a> ou tout simplement du <a href="http://www.fabfile.org/" rel="nofollow"><!--[-->Fabric<!--]--></a> ou du Ansible piloté par Jenkins.<!--]--></p><p><!--[-->D’ailleurs si vous avez des suggestions ou des retours je suis preneur.<!--]--></p><p><!--[-->Ok, dans cette configuration certains vont me dire qu’il reste de le souci de la disponibilité. Sauf que par expérience nous avons eu plusieurs “incidents” depuis qu’HopWork existe, que ce soit des indispos et crash de elasticsearch, des indispos Mongolab, Heroku ou carrément amazon, ce qui dans ce cas flingue tout le reste.<!--]--></p><p><!--[-->En centralisant sur un serveur, nous ne sommes dépendants que de ce serveur et nous gagnons sur les latences entre composants. Ok, il peut crasher, d’où le fait de tout automatiser pour rapidement remonter un autre serveur.<!--]--></p><p><!--[-->Certains pourraient poser la question “mais quitte à gérer votre plateforme, pourquoi pas du IAAS avec <a href="https://aws.amazon.com/fr/ec2/" rel="nofollow"><!--[-->Amazon EC2<!--]--></a> ou <a href="https://cloud.google.com/products/compute-engine/" rel="nofollow"><!--[-->Google Cloud<!--]--></a> ?”.<!--]--></p><p><!--[-->D’autres encore pourraient demander “mais pourquoi pas Cloudwat ou Numergy”, et là ce serait une grosse tranche de rire. Mais passons...<!--]--></p><p><!--[-->Concernant EC2 déjà, j’avoue que je trouve leur grille de prix n’est pas simple pour s’y retrouver. Vous avez des instances à la demandes, des instances réservées pour utilisation modérées ou intensives, des instances ponctuelles, vous avez des tarifs pour transferts de données (?! WTF), des instances optimisées pour EBS (?!). En fait, rien que <a href="https://aws.amazon.com/fr/ec2/pricing/" rel="nofollow"><!--[-->la page de pricing simplifiée<!--]--></a> est d’une longueur infinie. Et <a href="http://calculator.s3.amazonaws.com/index.html" rel="nofollow"><!--[-->leur calculette<!--]--></a> fait pas rêver non plus. En essayant vaguement de jouer avec la calculette pour une instance médium avec disque SSD et 3Gb de ram j’arrive tout de même à 56$/mois et je n’ai rien rempli dans les parties Data Transfert ou ElasticIP.<!--]--></p><p><!--[-->Bref, c’est obscur et pas si rentable si on compare à la machine que j’ai décrit plus haut pour le même prix.<!--]--></p><p><!--[-->Google Compute Engine <a href="https://cloud.google.com/products/compute-engine/#pricing" rel="nofollow"><!--[-->a une grille de tarif<!--]--></a> à peine aussi claire. Cette fois on ne sait même pas quelle disque est disponible mais on retombe grosso modo sur le même prix que ci-dessus pour 3Gb de ram. Encore une fois, toutes les options du bas de page laisse penser que dès qu’on veut du disque ou une IP ca coute encore plus cher.<!--]--></p><p><!--[-->Dans les deux cas il s’agit de VM. Pour ma part j’ai des expériences pas très heureuses en ce qui concerne les performances IO et la virtualisation donc déjà sur le principe je ne suis pas emballé.<!--]--></p><p><!--[-->Bref, je ne demande qu’à être convaincu par quelqu’un ayant déjà utilisé (et je ne parle pas d’avoir juste jouer a spawner une instance).<!--]--></p><p><!--[-->Voilà, vous savez tout. Nous ne savons pas avec certitude s’il s’agit du meilleur choix mais nous avons fait en sorte de pouvoir changer d’avis par la suite. Dans les prochains billets je reparlais peut-être d’Ansible ou de quelques outils mis en place pour notre infra.<!--]--></p><p><!--[-->A bientôt<!--]--></p></div></div></div></div><div class="mt-10 text-slate-600 font-extrabold text-sm font-medium min-w-full mx-auto mb-2"><a href="https://github.com/hlassiege/eventuallycoding/blob/master/content/articles/2014/05/09/paas-or-not-paas-that-is-the-question.md" rel="noopener noreferrer" target="_blank">Edit on Github <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 inline-block text-slate-600 -mt-1" viewBox="0 0 512 512"><path d="M320 0c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L448 109.3V192c0 17.7 14.3 32 32 32s32-14.3 32-32V32c0-17.7-14.3-32-32-32H320zM80 32C35.8 32 0 67.8 0 112V432c0 44.2 35.8 80 80 80H400c44.2 0 80-35.8 80-80V320c0-17.7-14.3-32-32-32s-32 14.3-32 32V432c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16H192c17.7 0 32-14.3 32-32s-14.3-32-32-32H80z"></path></svg></a></div><hr class="mb-8"><div><span class="font-proxima text-sm md:text-xl font-medium"> Did you like this blog post? </span><div class="mt-4 flex flex-row"><div><a href="https://facebook.com/sharer/sharer.php?u=https://eventuallycoding.com/2014/05/09/paas-or-not-paas-that-is-the-question" target="_blank" rel="noopener" aria-label="Share on Facebook"><button aria-label="Share on Facebook" type="button" class="text-white bg-[#3b5998] hover:bg-[#3b5998]/90 focus:ring-4 focus:outline-none focus:ring-[#3b5998]/50 font-medium rounded-lg text-sm px-3 py-3 text-center inline-flex items-center dark:focus:ring-[#3b5998]/55 mr-2 mb-2"><svg class="w-6 h-6" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook-f" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M279.1 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.4 0 225.4 0c-73.22 0-121.1 44.38-121.1 124.7v70.62H22.89V288h81.39v224h100.2V288z"></path></svg></button></a></div><div><a href="https://twitter.com/share?url=https://eventuallycoding.com/2014/05/09/paas-or-not-paas-that-is-the-question&amp;text=PAAS or not PAAS, that is the question&amp;via=hugolassiege" target="_blank" title="Share on Twitter" rel="noopener noreferrer" aria-label="Share on Twitter"><button aria-label="Share on Twitter" type="button" class="text-white bg-[#1da1f2] hover:bg-[#1da1f2]/90 focus:ring-4 focus:outline-none focus:ring-[#1da1f2]/50 font-medium rounded-lg text-sm px-3 py-3 text-center inline-flex items-center dark:focus:ring-[#1da1f2]/55 mr-2 mb-2"><svg class="w-6 h-6" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.4 151.7c.325 4.548 .325 9.097 .325 13.65 0 138.7-105.6 298.6-298.6 298.6-59.45 0-114.7-17.22-161.1-47.11 8.447 .974 16.57 1.299 25.34 1.299 49.06 0 94.21-16.57 130.3-44.83-46.13-.975-84.79-31.19-98.11-72.77 6.498 .974 12.99 1.624 19.82 1.624 9.421 0 18.84-1.3 27.61-3.573-48.08-9.747-84.14-51.98-84.14-102.1v-1.299c13.97 7.797 30.21 12.67 47.43 13.32-28.26-18.84-46.78-51.01-46.78-87.39 0-19.49 5.197-37.36 14.29-52.95 51.65 63.67 129.3 105.3 216.4 109.8-1.624-7.797-2.599-15.92-2.599-24.04 0-57.83 46.78-104.9 104.9-104.9 30.21 0 57.5 12.67 76.67 33.14 23.72-4.548 46.46-13.32 66.6-25.34-7.798 24.37-24.37 44.83-46.13 57.83 21.12-2.273 41.58-8.122 60.43-16.24-14.29 20.79-32.16 39.31-52.63 54.25z"></path></svg></button></a></div><div class=""><a href="https://www.buymeacoffee.com/hlassiege" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-red.png" alt="Buy Me A Coffee" style="height:48px !important;width:209px !important;"></a></div></div></div><div id="hyvor-talk-view"></div></div></div><!--]--><!--]--><footer class="lg:mt-40 border-t border-t-2"><div class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a aria-label="Open RSS feed" target="_self" href="/rss.xml" class="text-sm text-gray-500 transition hover:text-gray-600"><img alt="RSS" class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/rss.9e0b880c.svg"></a><a aria-label="Open Mastodon profile" class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="me" href="https://piaille.fr/@hugolassiege"><span class="sr-only">Mastodon</span><img alt="Mastodon" class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/mastodon.f0ecdde8.svg"></a><a aria-label="Open github profile" class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="nofollow noopener noreferrer" href="https://github.com/hlassiege"><span class="sr-only">github</span><img alt="github" class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/github_new.4e3fe23c.svg"></a><a aria-label="Open linkedin profile" class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/hugolassiege/"><span class="sr-only">Linkedin</span><img alt="Linkedin" class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/linkeding.34c3bc6d.svg"></a><a aria-label="Open twitter profile" target="_blank" rel="nofollow noopener noreferrer" href="https://twitter.com/hugolassiege" class="text-sm text-gray-500 transition hover:text-gray-600"><img alt="Twitter" class="transition-transform hover:scale-110 w-8 h-8" src="/_nuxt/twitter.457cff27.svg"></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Copyright © 2023</div><div>•</div> EventuallyCoding - A la fin de l&#39;envoi, je code !</div><div class="text-sm text-gray-500"> Credits to www.freepik.com - <a href="https://www.freepik.com/vectors/citizen">Citizen vector created by freepik - </a><a href="https://www.freepik.com/vectors/css">Css vector created by vectorjuice</a></div></div></footer></div></section><!--]--></div><script type="module">import p from "/2014/05/09/paas-or-not-paas-that-is-the-question/_payload.js";window.__NUXT__={...p,...((function(a,b){return {state:{},_errors:{},serverRendered:true,config:{public:{content:{locales:[],defaultLocale:b,integrity:1679472134348,experimental:{stripQueryParameters:a,clientDB:a},api:{baseURL:"\u002Fapi\u002F_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"prose-code",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:a,wsUrl:b,documentDriven:a,host:b,trailingSlash:a,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"\u002F",buildAssetsDir:"\u002F_nuxt\u002F",cdnURL:b}},prerenderedAt:1679472172153}}(false,"")))}</script><script type="module" src="/_nuxt/entry.215acb14.js" crossorigin></script><script type="module" src="/_nuxt/default.8bde6c5b.js" crossorigin></script><script type="module" src="/_nuxt/_id_.17522db5.js" crossorigin></script><script type="module" src="/_nuxt/ContentRenderer.1f0e0fa2.js" crossorigin></script><script type="module" src="/_nuxt/ContentRendererMarkdown.ef476ca4.js" crossorigin></script><script type="module" src="/_nuxt/ProseP.a08a8556.js" crossorigin></script><script type="module" src="/_nuxt/ProseH2.47da4369.js" crossorigin></script><script type="module" src="/_nuxt/ProseA.f7a1a7a8.js" crossorigin></script><script type="module" src="/_nuxt/ProseUl.ec4b424e.js" crossorigin></script><script type="module" src="/_nuxt/ProseLi.a40261ef.js" crossorigin></script><script type="module" src="/_nuxt/ProseStrong.4f906ff3.js" crossorigin></script><script type="module" src="/_nuxt/ProseImg.5114fcaa.js" crossorigin></script><script type="module" src="/_nuxt/ProseBlockquote.69b83896.js" crossorigin></script><script type="module" src="/_nuxt/ProseEm.9338c12f.js" crossorigin></script></body>
</html>